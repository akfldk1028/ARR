# λ²•λ Ή μ „μ²λ¦¬ νμ΄ν”„λΌμΈ κ°€μ΄λ“

## π― μ „μ²΄ μ›ν¬ν”λ΅μ°

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                         Step 1: PDF β†’ JSON                       β”‚
β”‚                      (1μ°¨ νμ‹± - κµ¬μ΅°ν™”)                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                                 β†“
                    PDF (doc/*.pdf)
                                 β†“
                         [pdf_to_json.py]
                                 β†“
                    ν‘μ¤€ JSON (parsed/*.json)
                    - μ΅°/ν•­/νΈ/λ© κµ¬μ΅°ν™”
                    - κ°μ • μ΄λ ¥ μ¶”μ¶
                    - λ²•λ¥  μΈμ© κ΄€κ³„
                                 β†“
                        (μ €μ¥ & λ‚μ¤‘μ—)
                                 β†“
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β†“                                               β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                 β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚   Step 2a: JSON β†’ Neo4j  β”‚                 β”‚   Step 2b: JSON β†’ RAG   β”‚
β”‚   (κ·Έλν”„ DB μ €μ¥)        β”‚                 β”‚   (μ²­ν‚Ή & μ„λ² λ”© μ¤€λΉ„)   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                 β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β†“                                               β†“
[json_to_neo4j.py]                          [json_to_rag.py]
        β†“                                               β†“
    Neo4j DB                                    μ²­ν¬ JSON (rag/*.json)
  + λ°±μ—… JSON                                   - μ΅°μ „μ²΄/ν•­/νΈ λ λ²¨
(neo4j/*.json)                                  - λ²•μ  λ§¥λ½ λ³΄μ΅΄
```

---

## π“¦ λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```
CA/
β”β”€β”€ doc/              # μ›λ³Έ PDF λ²•λ Ή λ¬Έμ„
β”‚   β”β”€β”€ κ±΄μ¶•λ²•.pdf
β”‚   β””β”€β”€ ...
β”‚
β”β”€β”€ parsed/           # Step 1 μ¶λ ¥: ν‘μ¤€ JSON
β”‚   β”β”€β”€ κ±΄μ¶•λ²•_λ²•λ¥ .json
β”‚   β””β”€β”€ ...
β”‚
β”β”€β”€ neo4j/            # Step 2a μ¶λ ¥: Neo4j λ°±μ—…
β”‚   β”β”€β”€ κ±΄μ¶•λ²•_neo4j.json
β”‚   β””β”€β”€ ...
β”‚
β””β”€β”€ rag/              # Step 2b μ¶λ ¥: RAG μ²­ν¬
    β”β”€β”€ κ±΄μ¶•λ²•_chunks.json
    β””β”€β”€ ...
``` 

---

## π€ μ‚¬μ©λ²•

### Step 1: PDF β†’ ν‘μ¤€ JSON (ν•„μ)

```bash
# λ‹¨μΌ PDF μ²λ¦¬
python pdf_to_json.py --pdf doc/κ±΄μ¶•λ²•.pdf

# doc ν΄λ” μ „μ²΄ μ²λ¦¬
python pdf_to_json.py --all

# νΉμ • ν¨ν„΄λ§ μ²λ¦¬
python pdf_to_json.py --all --pattern "*λ²•λ¥ *.pdf"
```

**κ²°κ³Ό:** `parsed/` ν΄λ”μ— ν‘μ¤€ JSON μƒμ„±

### Step 2a: JSON β†’ Neo4j (μ„ νƒ)

```bash
# ν™κ²½ λ³€μ μ„¤μ • (.env νμΌ)
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_password

# λ‹¨μΌ JSON β†’ Neo4j
python json_to_neo4j.py --json parsed/κ±΄μ¶•λ²•_λ²•λ¥ .json

# parsed ν΄λ” μ „μ²΄ β†’ Neo4j
python json_to_neo4j.py --all
```

**κ²°κ³Ό:** Neo4j DBμ— μ €μ¥ + `neo4j/` ν΄λ”μ— λ°±μ—…

### Step 2b: JSON β†’ RAG μ²­ν¬ (μ„ νƒ)

```bash
# λ‹¨μΌ JSON β†’ μ²­ν¬
python json_to_rag.py --json parsed/κ±΄μ¶•λ²•_λ²•λ¥ .json

# parsed ν΄λ” μ „μ²΄ β†’ μ²­ν¬
python json_to_rag.py --all
```

**κ²°κ³Ό:** `rag/` ν΄λ”μ— μ²­ν¬ JSON μƒμ„±

---

## π“‹ ν‘μ¤€ JSON ν•μ‹

### κµ¬μ΅°

```json
{
  "law_info": {
    "law_name": "κ±΄μ¶•λ²•",
    "law_type": "λ²•λ¥ ",
    "source_file": "κ±΄μ¶•λ²•.pdf",
    "parsed_at": "2025-10-25T18:30:00",
    "total_units": 150
  },
  "units": [
    {
      "unit_type": "μ΅°",
      "unit_number": "3μ΅°",
      "title": "μ μ© μ μ™Έ",
      "content": "μ 3μ΅°(μ μ© μ μ™Έ) β‘  ...",
      "unit_path": "μ 3μ΅°",
      "full_id": "κ±΄μ¶•λ²•::μ 3μ΅°",
      "parent_id": "κ±΄μ¶•λ²•",
      "order": 1,
      "revision_dates": ["2016. 1. 19."],
      "metadata": {
        "referenced_laws": ["λ¬Έν™”μ μ‚°μ λ³΄μ΅΄ λ° ν™μ©μ— κ΄€ν• λ²•λ¥ "]
      }
    }
  ]
}
```

μμ„Έν• λ‚΄μ©: [STANDARD_JSON_FORMAT.md](STANDARD_JSON_FORMAT.md)

---

## π― RAG μ²­ν¬ ν•μ‹

### λ‹¤μ¤‘ λ λ²¨ μ²­ν‚Ή

**Level 1: μ΅°μ „μ²΄** (λ„“μ€ λ§¥λ½)
```json
{
  "chunk_id": "chunk_00001",
  "chunk_level": "μ΅°μ „μ²΄",
  "content": "μ 3μ΅°(μ μ© μ μ™Έ) β‘  ... β‘΅ ...",
  "source_ids": ["κ±΄μ¶•λ²•::μ 3μ΅°", "κ±΄μ¶•λ²•::μ 3μ΅°::β‘ ", ...],
  "metadata": {
    "jo_number": "3μ΅°",
    "jo_title": "μ μ© μ μ™Έ"
  }
}
```

**Level 2: ν•­λ‹¨μ„** (μ΅°κ±΄λ³„)
```json
{
  "chunk_level": "ν•­λ‹¨μ„",
  "content": "μ 3μ΅°(μ μ© μ μ™Έ) β‘  λ‹¤μ κ° νΈ... 1. λ¬Έν™”μ μ‚° 2. μ² λ„μ‹μ„¤",
  "metadata": {
    "hang_number": "β‘ ",
    "ho_count": 3
  }
}
```

**Level 3: νΈλ‹¨μ„** (μ„Έλ°€ κ²€μƒ‰)
```json
{
  "chunk_level": "νΈλ‹¨μ„",
  "content": "μ 3μ΅°(μ μ© μ μ™Έ) β‘  ...μ μ©ν•μ§€ μ•„λ‹ν•λ‹¤. 1. λ¬Έν™”μ μ‚°...",
  "metadata": {
    "ho_number": "1",
    "referenced_laws": ["λ¬Έν™”μ μ‚°μ λ³΄μ΅΄ λ° ν™μ©μ— κ΄€ν• λ²•λ¥ "]
  }
}
```

μμ„Έν• λ‚΄μ©: [LEGAL_CHUNKING_GUIDE.md](LEGAL_CHUNKING_GUIDE.md)

---

## π’΅ ν•µμ‹¬ νΉμ§•

### 1. λ¶„λ¦¬λ νμ΄ν”„λΌμΈ
- Step 1 (PDF β†’ JSON)μ€ ν• λ²λ§ μ‹¤ν–‰
- Step 2a, 2bλ” ν•„μ”ν•  λ• λ…λ¦½μ μΌλ΅ μ‹¤ν–‰
- JSON νμΌλ΅ λ²„μ „ κ΄€λ¦¬ κ°€λ¥

### 2. λ²•μ  μλ―Έ λ³΄μ΅΄
- λ¨λ“  μ²­ν¬λ” μ΅° μ λ© + ν•­ λ„μ…λ¶€ ν¬ν•¨
- νΈλ” μ λ€ ν•­κ³Ό λ¶„λ¦¬λμ§€ μ•μ
- λ²•μ μΌλ΅ μ™„μ „ν• μ •λ³΄ μ κ³µ

### 3. μ μ—°ν• μ²λ¦¬
- λ‹¨μΌ νμΌ λλ” μΌκ΄„ μ²λ¦¬
- μ‹¤ν¨ μ‹ μ—λ¬ ν•Έλ“¤λ§
- μ§„ν–‰ μƒν™© λ΅κ·Έ

---

## π”§ μμ΅΄μ„±

### ν•„μ

```bash
pip install PyPDF2 pdfplumber  # PDF μ¶”μ¶
```

### Step 2a (Neo4j) μ‚¬μ© μ‹

```bash
pip install neo4j python-dotenv
```

Neo4j μ‹¤ν–‰:
```bash
docker run -d --name neo4j \
  -p 7474:7474 -p 7687:7687 \
  -e NEO4J_AUTH=neo4j/your_password \
  neo4j:latest
```

---

## π“ μ„±λ¥

### μμƒ μ²λ¦¬ μ‹κ°„ (κ±΄μ¶•λ²• κΈ°μ¤€)

- **Step 1 (PDF β†’ JSON)**: 5-10μ΄
  - PDF μ¶”μ¶: 2-3μ΄
  - ν…μ¤νΈ νμ‹±: 2-5μ΄
  - JSON μ €μ¥: <1μ΄

- **Step 2a (JSON β†’ Neo4j)**: 10-30μ΄
  - JSON μ½κΈ°: <1μ΄
  - λ³€ν™: 1-2μ΄
  - Neo4j μ μ¬: 5-20μ΄

- **Step 2b (JSON β†’ RAG)**: 3-5μ΄
  - JSON μ½κΈ°: <1μ΄
  - μ²­ν‚Ή: 1-3μ΄
  - JSON μ €μ¥: <1μ΄

---

## β οΈ μ£Όμμ‚¬ν•­

### PDF ν’μ§
- PDF ν…μ¤νΈ μ¶”μ¶ ν’μ§μ— λ”°λΌ κ²°κ³Όκ°€ λ‹¬λΌμ§ μ μμ
- μ¤μΊ” PDFλ” OCR ν•„μ”
- λ μ΄μ•„μ›ƒμ΄ λ³µμ΅ν• PDFλ” μλ™ κ²€ν†  κ¶μ¥

### Neo4j μ—°κ²°
- Neo4jκ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ
- URI, μ‚¬μ©μλ…, λΉ„λ°€λ²νΈ μ •ν™•ν μ…λ ¥
- λ°©ν™”λ²½ ν¬νΈ 7687 μ—΄λ ¤ μλ”μ§€ ν™•μΈ

### λ©”λ¨λ¦¬
- λ€μ©λ‰ λ²•λ Ή μ²λ¦¬ μ‹ λ©”λ¨λ¦¬ μ‚¬μ©λ‰ μ¦κ°€
- ν•„μ” μ‹ λ°°μΉ ν¬κΈ° μ΅°μ •

---

## π› λ¬Έμ  ν•΄κ²°

### PDF μ¶”μ¶ μ‹¤ν¨
```bash
# PyPDF2λ΅ μ‹¤ν¨ μ‹ pdfplumber μ‚¬μ©
pip install pdfplumber

# pdfplumberκ°€ μ• λλ©΄ μλ™ ν…μ¤νΈ μ¶”μ¶
```

### Neo4j μ—°κ²° μ‹¤ν¨
```bash
# Neo4j μƒνƒ ν™•μΈ
docker ps | grep neo4j

# Neo4j μ¬μ‹μ‘
docker restart neo4j

# λ΅κ·Έ ν™•μΈ
docker logs neo4j
```

### νμ‹± μ¤λ¥
- λ²•λ Ή ν•μ‹μ΄ ν‘μ¤€κ³Ό λ‹¤λ¥Ό μ μμ
- `parsed/` ν΄λ”μ JSON μλ™ ν™•μΈ
- ν•„μ” μ‹ μ •κ·μ‹ ν¨ν„΄ μ΅°μ •

---

## π“ κ΄€λ ¨ λ¬Έμ„

- [STANDARD_JSON_FORMAT.md](STANDARD_JSON_FORMAT.md) - ν‘μ¤€ JSON ν•μ‹ μƒμ„Έ
- [LEGAL_CHUNKING_GUIDE.md](LEGAL_CHUNKING_GUIDE.md) - λ²•λ Ή μ²­ν‚Ή μ›μΉ™
- [neo4j_schema.md](neo4j_schema.md) - Neo4j μ¤ν‚¤λ§ μ„¤κ³„
- [README_NEO4J.md](README_NEO4J.md) - Neo4j μ‚¬μ© κ°€μ΄λ“

---

## π‰ λ‹¤μ λ‹¨κ³„

### 1. λ²΅ν„° DB μ—°λ™
```python
from openai import OpenAI

# RAG μ²­ν¬ μ„λ² λ”©
client = OpenAI()
with open("rag/κ±΄μ¶•λ²•_chunks.json") as f:
    data = json.load(f)

for chunk in data['chunks']:
    embedding = client.embeddings.create(
        model="text-embedding-3-large",
        input=chunk['content']
    ).data[0].embedding

    # Pinecone/Weaviate/Qdrantμ— μ €μ¥
    vector_db.upsert(
        id=chunk['chunk_id'],
        vector=embedding,
        metadata=chunk['metadata']
    )
```

### 2. RAG μ‹μ¤ν… κµ¬μ¶•
- λ²΅ν„° κ²€μƒ‰
- Neo4j κ·Έλν”„ νƒμƒ‰
- LLM λ‹µλ³€ μƒμ„±

### 3. λ²•λ Ή μ—…λ°μ΄νΈ μ¶”μ 
- κ°μ • μ΄λ ¥ λΉ„κµ
- λ³€κ²½μ‚¬ν•­ κ°μ§€
- μλ™ μ—…λ°μ΄νΈ

---

**ν”„λ΅μ νΈ μ™„λ£!** π‰

μ΄μ  PDF λ²•λ Ήμ„ JSONμΌλ΅ νμ‹±ν•κ³ , λ‚μ¤‘μ— Neo4jλ‚ RAGλ΅ λ³€ν™ν•  μ μμµλ‹λ‹¤.
